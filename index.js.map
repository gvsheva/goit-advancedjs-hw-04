{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nexport default async function makeSearchRequest({\n  key,\n  q,\n  type = 'photo',\n  orientation = 'horizontal',\n  safesearch = true,\n  page = 1,\n  perPage = 20,\n}) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key,\n      q,\n      image_type: type,\n      orientation,\n      safesearch,\n      page,\n      per_page: perPage,\n    },\n  });\n  return response.data;\n}","'use strict';\n\nexport default async function createGalleryItem({\n  preview,\n  original,\n  description,\n}) {\n  return new Promise(resolve => {\n    const img = document.createElement('img');\n    img.src = preview;\n    img.dataset.source = original;\n    img.alt = description;\n    img.classList.add('gallery-image');\n    const a = document.createElement('a');\n    const li = document.createElement('li');\n    a.appendChild(img);\n    a.classList.add('gallery-link');\n    a.href = original;\n    li.appendChild(a);\n    li.classList.add('gallery-item');\n    img.onload = () => resolve(li);\n  });\n}\n\n// export default function renderItem({ largeImageURL, webformatURL, tags }) {\n//   return `<li class=\"gallery-item\">\n//           <a class=\"gallery-link\" href=\"${largeImageURL}\">\n//             <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n//           </a>\n//         </li>`;\n// }","'use strict';\n\nimport SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport makeSearchRequest from './js/pixabay-api.js';\nimport createGalleryItem from './js/render-functions.js';\n\nconst form = document.getElementById('searching-form');\nconst loader = document.getElementById('loader');\nconst loadMore = document.getElementById('load-more');\nconst gallery = document.getElementById('gallery');\n\nconst key = '49622419-312bd19c735093b11668a437b';\nconst perPage = 15;\n\nlet loadedImages = 0;\n\nconst lightbox = new SimpleLightbox('.gallery-item > a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction requestParams() {\n  return {\n    key: key,\n    q: form.elements.search.value,\n    orientation: form.elements.orientation.value,\n    type: form.elements.type.value,\n    sefesearch: form.elements.safesearch.value,\n    page: Math.ceil(loadedImages / perPage) + 1,\n    perPage: perPage,\n  };\n}\n\nasync function load() {\n  loader.dataset.hidden = false;\n  loadMore.dataset.hidden = true;\n\n  try {\n    const data = await makeSearchRequest(requestParams());\n    const hits = data.hits;\n    const totalHits = data.totalHits;\n    if (hits.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message: 'No images found!',\n      });\n      return;\n    }\n    const nchildren = gallery.children.length;\n    const items = await Promise.all(\n      hits.map(async i => {\n        return await createGalleryItem({\n          original: i.largeImageURL,\n          preview: i.webformatURL,\n          description: i.tags,\n        });\n      })\n    );\n    gallery.append(...items);\n\n    loadedImages += hits.length;\n    if (loadedImages < totalHits) {\n      iziToast.info({\n        title: 'Info',\n        message: `Loaded ${loadedImages} of ${totalHits} images. Please click \"Load more\" to load the rest of the images.`,\n      });\n      loadMore.dataset.hidden = false;\n    } else {\n      iziToast.success({\n        title: 'Success',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    lightbox.refresh();\n    gallery.children[nchildren].scrollIntoView({\n      behavior: 'smooth',\n      block: 'start',\n    });\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      title: 'Error',\n      message: err,\n    });\n  } finally {\n    loader.dataset.hidden = true;\n  }\n}\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  loadedImages = 0;\n  gallery.innerHTML = '';\n\n  if (form.elements.search.value === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query!',\n    });\n    return;\n  }\n\n  await load();\n});\n\nloadMore.addEventListener('click', load);"],"names":["makeSearchRequest","key","q","type","orientation","safesearch","page","perPage","axios","createGalleryItem","preview","original","description","resolve","img","a","li","form","loader","loadMore","gallery","loadedImages","lightbox","SimpleLightbox","requestParams","load","data","hits","totalHits","iziToast","nchildren","items","i","err","event"],"mappings":"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"}